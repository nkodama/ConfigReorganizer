Config Reorganizer Ver 0.05

■はじめに

  Arsenal of Democracy英語版を日本語化するための補助ツールです。
  EU2エンジンを使用している他のパラドゲーでも使用できると思います。

  .NET Framework2.0のインストールが必要です。

■使用方法

  ややこしいので、ユースケース別に記載します。

1. AoD1.05パッチの和訳テキストを、AoD1.04の和訳を利用して作成する。

  AoD1.05パッチでは、configフォルダ以下の文字列に大きく変更があり、
  旧バージョンとは別のファイルに定義されていたりします。
  このツールでは、1.04の既訳文字列を流用して、
  1.05用の和訳テキストを作成することができます。
  当然ながら、1.05の新規部分は英語のままです。

  a. ツールを起動する。
  b. 対象フォルダ欄にAoD1.05パッチのconfigフォルダ名を入力する。
  c. 参照フォルダ欄に1.04和訳のconfigフォルダ名を入力する。
  d. 出力フォルダ欄に適当なフォルダ名を指定する。
  e. 開始ボタンを押す。
  f. 指定した出力フォルダに1.05用和訳テキストが生成される。

2. 日本語版専用MODを英語版日本語化環境で使用する。

  英語版日本語化環境では、1行のテキスト長があまりにも長いと
  落ちてしまうという問題があります。
  日本語版専用となっているMODを英語版日本語化環境で使用すると
  大半はこの問題に引っかかってしまいますが、
  適度な文字数で改行文字を挿入することで回避できます。

  a. ツールを起動する。
  b. 対象フォルダ欄に日本語版MODのconfigフォルダ名を入力する。
  c. 出力フォルダ欄に適当なフォルダ名を指定する。
  d. 「対象フォルダの言語」を「日本語」に変更する。
  e. 「改行コード」を「文字数」または「ピクセル数」に変更する。
  f. 開始ボタンを押す。
  g. 指定した出力フォルダに、改行文字が挿入されたテキストが生成される。

3. 英語版の翻訳ベース環境を作成する。

  英語版を翻訳する際には、
    定義名;英語文字列;英語文字列;;;;;;;;;;X
  というファイルを作成してから
  1つ目の英語を日本語へ変換することになります。
  Ver0.03からは、この翻訳ベース環境を自動生成できます。

  a. ツールを起動する。
  b. 対象フォルダ欄に英語版のconfigフォルダ名を入力する。
  c. 出力フォルダ欄に適当なフォルダ名を指定する。
  d. 開始ボタンを押す。
  e. 指定した出力フォルダに翻訳ベース環境が生成される。

4. AoD1.04から1.05で追加された文字列を調べる。

  Ver0.03からは、対象フォルダに存在するが参照フォルダに存在しない定義名を
  ログ出力するようにしています。
  これを利用して、バージョン間の差分を調べることができます。

  a. ツールを起動する。
  b. 対象フォルダ欄にAoD1.05のconfigフォルダ名を入力する。
  c. 参照フォルダ欄にAoD1.04のconfigフォルダ名を入力する。
  d. 出力フォルダ欄に適当なフォルダ名を指定する。
  e. 開始ボタンを押す。
  f. ログ上に1.05で追加された定義名が表示される。

5. AoD日本語版1.04専用MODをAoD英語版1.05日本語化環境で使用する。

  MODWikiでMOD作者さんに迷惑をかけている人がいたので追記。
  基本1と2の応用で何とかなります。
  バニラ1.04と1.05の差分は日本語化されませんが、各自で工夫して下さい。
  (ヒント: 1.04-1.05の差分だけを新規CSVファイルへまとめておくと便利)

  a. AoD英語版1.04の日本語化テキストを準備する。
  b. AoD日本語版1.04専用MODのテキストをaで準備したテキストへ上書きする。
  c. ツールを起動する。
  d. 対象フォルダ欄にAoD英語版1.05のconfigフォルダ名を入力する。
  e. 参照フォルダ欄にbで準備したテキストのフォルダ名を入力する。
  f. 出力フォルダ欄に適当なフォルダ名を指定する。
  g. 「改行コード」を「文字数」または「ピクセル数」に変更する。
  h. 開始ボタンを押す。
  i. 指定した出力フォルダに、改行文字が挿入されたテキストが生成される。

6. IronCross/AoD版を少しだけ日本語化する。

  AoDとMOD34の和訳を流用してみます。
  日本語版が出ても後悔しない人だけ試して下さい。

  a. 適当なフォルダを作成する。
  b. AoD英語版1.05の日本語化テキストをaで作成したフォルダ内へコピーし、
     フォルダ名を適当な名前(config_originalなど)に変更する。
  c. MOD34の日本語化テキストをaで作成したフォルダ内へコピーし、
     フォルダ名を適当な名前(config_mod34など)に変更する。
  d. 対象フォルダ欄にIronCrossのconfigフォルダ名を入力する。
  e. 参照フォルダ欄にaで作成したフォルダ名を入力する。
  f. 出力フォルダ欄に適当なフォルダ名を指定する。
  g. 開始ボタンを押す。
  h. 指定した出力フォルダにIronCross用和訳テキストが生成される。

■動作仕様

- 基本的な動作

  参照フォルダ内のCSVファイルを全て読み込み、
  定義名と日本語文字列の組を生成します。
  サブフォルダ内のファイルも全て処理されますが、
  定義名が重複する場合は後から読み込まれた内容で上書きされます。

  その後、対象フォルダ内のCSVファイルを順に読み込み、
  定義名に対応する日本語文字列を探して出力します。

- 対象フォルダの言語

  対象フォルダ内のCSVファイルを読み込む際のコードページが変わります。

  英語の場合:   コードページ1252
  日本語の場合: コードページ932

- 参照フォルダの言語

  参照フォルダ内のCSVファイルを読み込む際のコードページが変わります。

  英語の場合:   コードページ1252
  日本語の場合: コードページ932

- 英語テキストを付加する

  日本語テキストの次に英語テキストを付加します。
  内部的な動作としては、各文字列定義の最初の言語文字列を、
  出力先の日本語文字列の次に挿入します。

  チェックONの場合:
    定義名;日本語文字列;英語文字列;;;;;;;;;;X
  チェックOFFの場合:
    定義名;日本語文字列;;;;;;;;;;;X

- 存在しない定義名をログ出力

  対象フォルダに定義があるが、参照フォルダに定義のない文字列を
  ログ出力します。
  バージョン間の差分を調べたい時に便利です。
  なお、AoDの和訳テキストを使ってIronCrossを日本語化する場合には、
  ログが大量に出力されて時間がかかるので、チェックを外した方がよいです。

- 行末の文字

  行の終わりは必ず「x」で終わることになっていますが、
  大文字、小文字の規定はありませんし、混在しています。
  元のまま変更しないか、常に小文字/大文字かを指定できます。

- 改行コード

  出力先の日本語文字列を改行文字で区切ります。
  文字数単位で区切るか、ピクセル数単位で区切るかを指定できます。

- フォント

  ピクセル数単位で改行コードを挿入する場合に、
  文字列幅計算の基準となるフォントを指定します。

- 禁則処理を行う

  改行コードで区切る場合に、ある程度の禁則処理を行います。
    + 次の行の先頭に禁則文字が来る場合は1文字追い出す。
    + 行末から次の行に数字が跨る場合は次の行へ追い出す。
    + 行末に禁則文字が来る場合は追い出す。

- 元の改行コードを残す

  改行コードで区切る前に、参照元のテキストの改行コードを除去します。
  英語版日本語化テキストをベースに改行コードを再計算する場合には、
  チェックを外します。

■注意事項

  このツールを使えば、日本語版のテキストを英語版日本語化環境で
  流用したりすることができますが、生成したテキストをアップローダに
  公開するといった、著作権に問題のある行為は慎んで下さい。

■変更履歴

  2013/11/30 Ver0.06
    未完- 禁則文字の処理をEuropaEnginePatherに合わせて変更
    未完- ビルド環境をVisual Studio 2012 + .NET Framework 3.5に変更

  2011/08/20 Ver0.05
    - 途中で改行コードが現れた場合、改行位置を再計算するように変更
    - 対象フォルダの言語が日本語の場合、英語テキストを付与しないように変更
    - ビルド環境をVisual Studio 2010 + ReSharper 6.0に変更

  2010/10/09 Ver0.04
    - 参照元テキストの改行コードを除去する機能を追加
    - 参照フォルダの言語を明示的に指定できるように変更
    - 存在しない定義名をログ出力する機能をON/OFFできるように変更
    - 参照フォルダ内のあらゆるサブフォルダを探索するように変更

  2010/09/28 Ver0.03
    - 存在しない定義名をログ出力するように変更
    - 参照フォルダの指定がない場合、対象フォルダの言語に合わせるように変更

  2010/09/01 Ver0.02
    - 指定ピクセル幅で折り返す処理の実装
    - 禁則処理を少し改善
    - 機能追加に合わせて、UI整理
    - ソースコードにコメントを少々追加

  2010/08/28 Ver0.01
    - 初版作成
